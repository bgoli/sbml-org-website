<!-- ==========================================================================
File name   : static.html
Description : Layout for pages that are wrappers around static pages
Author(s)   : Michael Hucka <mhucka@caltech.edu>
Organization: California Institute of Technology 
Date created: 2020-03-15

This is based on single.html.  It has two differences: (1) it reads the
variable "source" from the file that references this layout, and (2) it sets
the variable "static_source" before loading the partial file
page_header.html.  The value of "source" is read to create the content
displayed in the page, and the code in our custom "page_header.html" uses the
flag "static_source" to adjust its behavior to suit the use of static HTML.
========================================================================== -->

{{ $file := .Param "source" }}

{{ partial "header.html" (dict "Page" . "static_source" 1) }}
{{ partial "navbar.html" . }}

<div id="page-container">
  <div class="container">
    {{ partial "page_header.html" (dict "Page" . "static_source" 1) }}

    <article class="article" itemscope itemtype="http://schema.org/Article">
      {{ if ne $file "" }}
      <div class="article-style" itemprop="articleBody">
        {{ $fullpath := print "/static/" $file }}
        {{/* Filter out any CSS imports that be in the static files. */}}
        {{ readFile $fullpath | replaceRE "@import" "" | safeHTML}}
      </div>
      {{ end }}
  
      {{ partial "tags.html" . }}
  
      {{ if ne .Type "page" }}
        {{ partial "page_author.html" . }}
        {{ $related := .Site.RegularPages.Related . | first 5 }}
        {{ with $related }}
        <div class="article-widget">
          <div class="hr-light"></div>
          <h3>{{ i18n "related" }}</h3>
          <ul>
            {{ range . }}
            <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
            {{ end }}
          </ul>
        </div>
        {{ end }}
      {{ end }}
  
      {{ if .Site.Params.section_pager }}
      <div class="article-widget">
        {{ partial "section_pager.html" . }}
      </div>
      {{ end }}
  
      {{ partial "comments.html" . }}
  
    </article>
  </div>
  <section id="footer-section">
    {{ partial "footer_container.html" . }}
    {{ partial "footer.html" . }}
  </section>
</div>

