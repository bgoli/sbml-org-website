<!-- HTML header for Doxygen -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>libSBML C++ API: Step by step summary of the implementation of an extension</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="sbml.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="libSBML C++ API"/>
<link href="libsbml-doxygen-stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">libSBML C++ API
   &#160;<span id="projectnumber">5.18.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="group__core.html"><span>Core&#160;libSBML</span></a></li>
      <li><a href="usergroup0.html"><span>Level&#160;3&#160;Extensions</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="libsbml-example-files.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('libsbml-howto-implement-extension.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Step by step summary of the implementation of an extension </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#implem-dir">1. Create the directory structure</a></li>
<li class="level1"><a href="#implem-sbaseplugin">2. Derive classes from SBasePlugin</a></li>
<li class="level1"><a href="#implem-sbmldocument">3. Derive a class from SBMLDocumentPlugin if necessary</a></li>
<li class="level1"><a href="#implem-sbase">4. Derive classes from SBase</a></li>
<li class="level1"><a href="#implem-sbmlext">5. Derive a class from SBMLExtension</a></li>
<li class="level1"><a href="#forward-decl">6. Implement a forward declaration file</a></li>
<li class="level1"><a href="#header-file">7. Implement a package header file</a></li>
<li class="level1"><a href="#config-macros">8. Define files for package registration</a></li>
<li class="level1"><a href="#hook-bindings">9. Hook into the language bindings</a></li>
<li class="level1"><a href="#hook-build">10. Hook into the libSBML build system</a></li>
</ul>
</div>
<div class="textblock"><p>This section describes the steps necessary to implement a <em>package extension</em> (also known as a <em>package plugin</em>) for libSBML by hand. The purpose of this section is to document the process. In practice, the libSBML developers no longer write package extensions by hand, but instead, use a code generation system under development by the libSBML Team (a system called DEVISER, short for <em>Design Explorer and Viewer for Iterative SBML Enhancement of Representations</em>). This code generator embodies the steps below.</p>
<h1><a class="anchor" id="implem-dir"></a>
1. Create the directory structure</h1>
<p>The conventional structure for a libSBML package extension involves two main directories, one for the implementation sources and one for example code. The following illustrates this structure:</p>
<pre style="margin-left: 20px; line-height: 100%">
<span class="placeholder">package_root</span>
│
├── examples
│   ├── c
│   ├── c++
│   ├── csharp
│   ├── java
│   ├── javascript
│   ├── perl
│   ├── python
│   ├── r
│   └── ruby
│
└── src
    ├── bindings
    │   ├── csharp
    │   ├── java
    │   ├── javascript
    │   ├── perl
    │   ├── python
    │   ├── r
    │   ├── ruby
    │   └── swig
    │
    └── sbml
        └── packages
            │
            └── <span class="placeholder">package_name</span>
                │
                ├── common
                │   └── test
                ├── extension
                │   └── test
                ├── sbml
                │   └── test
                ├── util
                │   └── test
                └── validator
                    └── test
</pre><p>The top-level directory, <span class="placeholder">package_root</span>, can be named anything, although by convention it's named after the SBML Level&#160;3 package being implemented. The directory <span class="placeholder">package_name</span> should be the nickname or short-form name of the package (e.g., "comp" for the Hierarchical Model Composition package).</p>
<p>The directory structure for the implementation of the package (the tree root at <code>src</code>) is separated into two main branches: <code>bindings</code> for the programming language interfaces (known as the <em>language bindings</em> in libSBML-speak) generated with the help of SWIG, and <code>sbml</code> for actual package code. The subdirectories under <span class="placeholder">package_name</span> have the following purposes:</p>
<ul>
<li><code>common</code>: This contains header files that provide forward declarations for all the object classes defined by the package, plus any other common headers and/or code.</li>
</ul>
<ul>
<li><code>extension</code>: This contains the code for the all of the extensions of libSBML classes defined by the package. For example, if a package extends the <a class="el" href="class_model.html" title=" An SBML model. ">Model</a> object, this is where the extension class code is placed.</li>
</ul>
<ul>
<li><code>sbml</code>: This contains all the new SBML object classes defined by the package.</li>
</ul>
<ul>
<li><code>util</code>: As its name implies, this contains any utility classes or other code that a package might need in its implementation.</li>
</ul>
<ul>
<li><code>validator</code>: This contains code for SBML validation of the package constructs.</li>
</ul>
<p>Examples of real package extensions employing the directory structure described above can be found in the libSBML source distribution, in the <code>src/sbml/packages</code> subdirectory.</p>
<h1><a class="anchor" id="implem-sbaseplugin"></a>
2. Derive classes from SBasePlugin</h1>
<p>Certain classes in an SBML Level&#160;3 package will be subclasses of existing core SBML constructs, and other classes will be entirely ones introduced by the package. Existing SBML classes can be extended through the use of the special-purpose classes <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> and <a class="el" href="class_s_b_m_l_document_plugin.html" title=" Base class for extending SBMLDocument in packages. ">SBMLDocumentPlugin</a>, while new classes are implemented as objects derived from the basic <a class="el" href="class_s_base.html" title=" SBML&#39;s SBase class, base class of most SBML objects. ">SBase</a> class. We discuss <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> in this section, <a class="el" href="class_s_b_m_l_document_plugin.html" title=" Base class for extending SBMLDocument in packages. ">SBMLDocumentPlugin</a> in the next section, and the implementation of entirely new classes in the section after that.</p>
<p>The <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> class is libSBML's base class for extensions of core SBML component objects. It defines basic virtual methods for reading/writing/checking additional attributes and/or subobjects; and these methods should be overridden by subclasses to implement the necessary features of an extended SBML object. The documentation for the <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> class describes the steps necessary to use it to extend existing object classes. Here we summarize the steps:</p>
<ol>
<li>
<p class="startli"><em>Identify the SBML objects that need to be extended</em>. Any existing SBML object that gets new attributes or subobjects falls into this category. For instance, a package may need to extend <a class="el" href="class_model.html" title=" An SBML model. ">Model</a> to add new list of entities (as the SBML Level&#160;3 Layout package does with <a class="el" href="class_list_of_layouts.html" title=" A list of Layout objects. ">ListOfLayouts</a>).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><em>Create a <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> subclass for each extended SBML object class</em>. This involves several substeps, summarized briefly here:</p>
<ol style="list-style-type: lower-latin">
<li>
<p class="startli">Define protected data members and implement their initialization as well as their handling by assignment operators, copy operators, and other necessary operators or fields.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> class-related methods such as the class constructor, copy constructor, and others.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> virtual methods for attributes on the SBML object.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> virtual methods for subobjects, if the object class contains other classes of objects.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> virtual methods for XML namespaces, if the SBML package uses extra XML namespaces beyond the default SBML namespace.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Implement additional methods as needed.</p>
<p class="endli"></p>
</li>
</ol>
<p class="endli"></p>
</li>
</ol>
<p>A subclass of <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a>, <a class="el" href="class_s_b_m_l_document_plugin.html" title=" Base class for extending SBMLDocument in packages. ">SBMLDocumentPlugin</a>, is designed specifically for extending the top-level SBML container object. It should be used instead of <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a> to add attributes or subobjects to the <code>&lt;sbml&gt;</code> XML element, if an SBML package calls for it. The next section discusses this further.</p>
<p>In the directory structure for packages (<a class="el" href="libsbml-howto-implement-extension.html#implem-dir">1. Create the directory structure</a>), the code for extensions of existing libSBML classes is placed in the subdirectory named <code>extension</code>.</p>
<h1><a class="anchor" id="implem-sbmldocument"></a>
3. Derive a class from SBMLDocumentPlugin if necessary</h1>
<p>SBML Level&#160;3 packages typically do not make any changes to the top-level <code>&lt;sbml&gt;</code> XML element beyond adding an attribute named "required", so in most cases, the extension of <a class="el" href="class_s_b_m_l_document.html" title=" Overall SBML container object. ">SBMLDocument</a> is very simple. Here follows a summary of the basic steps; the documentation for the <a class="el" href="class_s_b_m_l_document_plugin.html" title=" Base class for extending SBMLDocument in packages. ">SBMLDocumentPlugin</a> class explains the steps in more detail.</p>
<ol>
<li>
<p class="startli"><em>Identify the changes necessary to <a class="el" href="class_s_b_m_l_document.html" title=" Overall SBML container object. ">SBMLDocument</a></em>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><em>Create the <a class="el" href="class_s_b_m_l_document_plugin.html" title=" Base class for extending SBMLDocument in packages. ">SBMLDocumentPlugin</a> subclass</em>. This involves several substeps:</p>
<ol style="list-style-type: lower-latin">
<li>
<p class="startli">Override class-related methods derived from <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a>, the parent class of <a class="el" href="class_s_b_m_l_document_plugin.html" title=" Base class for extending SBMLDocument in packages. ">SBMLDocumentPlugin</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Determine the necessary value of the "required" attribute and set up the class implementation to set/test/manage the value accordingly.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Define protected data members, if the package definition requires any.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override virtual methods for new attributes, if any.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override virtual methods for subobjects, if the package defines any new objects under the top-level <code>&lt;sbml&gt;</code> XML element.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override virtual methods for XML namespaces.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Implement additional methods as needed.</p>
<p class="endli"></p>
</li>
</ol>
</li>
</ol>
<p>In the directory structure for packages (Section <a class="el" href="libsbml-howto-implement-extension.html#implem-dir">1. Create the directory structure</a>), the code using <a class="el" href="class_s_b_m_l_document_plugin.html" title=" Base class for extending SBMLDocument in packages. ">SBMLDocumentPlugin</a> is placed in the subdirectory named <code>extension</code>, grouped together with the classes derived from <a class="el" href="class_s_base_plugin.html" title=" Base class for extending SBML objects in packages. ">SBasePlugin</a>.</p>
<h1><a class="anchor" id="implem-sbase"></a>
4. Derive classes from SBase</h1>
<p>As mentioned above, some classes in SBML Level&#160;3 package specifications typically are defined as subclasses of existing core SBML objects such as <a class="el" href="class_model.html" title=" An SBML model. ">Model</a>, <a class="el" href="class_reaction.html" title=" An SBML reaction between species in an SBML model. ">Reaction</a>, <a class="el" href="class_parameter.html" title=" An SBML parameter: a named symbol with a value. ">Parameter</a>, and so forth, while others are defined as entirely new classes. If the package specification calls for <em>new</em> SBML objects derived from SBML's abstract <em><b>SBase</b></em> class, the libSBML package extension should implemented them by deriving them from the libSBML <a class="el" href="class_s_base.html" title=" SBML&#39;s SBase class, base class of most SBML objects. ">SBase</a> class.</p>
<p>The following are the basic steps to subclassing <a class="el" href="class_s_base.html" title=" SBML&#39;s SBase class, base class of most SBML objects. ">SBase</a> for the implementation of each new SBML object class:</p>
<ol>
<li>
<p class="startli"><em>Identify the attributes of the class</em>. Objects will have attributes, subobjects (usually either for a mathematical formula or a list of subobjects inside a <a class="el" href="class_list_of.html" title=" Parent class for libSBML&#39;s &quot;ListOfXYZ&quot; classes. ">ListOf</a>), or a mixture of both. When an object has attributes, each attribute will have a data type; this data type will be either one of the core SBML primitive types or a new type defined in the specification for the package. The first step is to gather the requirements for these attributes.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><em>Identify the subobjects of each object class</em>. Another necessary requirements analysis step is determining if any subobjects need to be defined and contained withing other objects. Any that are subclassed from <a class="el" href="class_s_base.html" title=" SBML&#39;s SBase class, base class of most SBML objects. ">SBase</a> will be their own separate class, and will be contained inside another class derived from <a class="el" href="class_list_of.html" title=" Parent class for libSBML&#39;s &quot;ListOfXYZ&quot; classes. ">ListOf</a>. (For example, <a class="el" href="class_list_of_layouts.html" title=" A list of Layout objects. ">ListOfLayouts</a> in the SBML Level&#160;3 Layout package.)</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><em>Write the implementation of each class</em>.</p>
<ol style="list-style-type: lower-latin">
<li>
<p class="startli">Define protected data members that store identified subobjects and/or attributes. For example, the the <code>Groups</code> class in the Groups package needs protected data members for the object identifier ("id") attribute, object name ("name") attribute, a list of <code><a class="el" href="class_member.html" title=" The Member class defines what objects are parts of a Group. ">Member</a></code> objects (stored in a <code><a class="el" href="class_list_of_members.html" title=" A list of Member objects. ">ListOfMembers</a></code> class object derived from <a class="el" href="class_list_of.html" title=" Parent class for libSBML&#39;s &quot;ListOfXYZ&quot; classes. ">ListOf</a>), and more. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Define the following two class constructors: (i) a constructor that accepts three arguments for the SBML Level, SBML Version, and package version; and (ii) a constructor that accepts an object derived from <a class="el" href="class_s_b_m_l_namespaces.html" title=" Set of SBML Level + Version + namespace triples. ">SBMLNamespaces</a>. Make sure that the implementation of the constructor calls the parent's constructor, and that the default SBML Level, Version and package version are given as default arguments. The implementation also has to call the method <code>setSBMLNamespacesAndOwn()</code> with the package-specific <a class="el" href="class_s_b_m_l_extension_namespaces.html" title=" Set of SBML Level + Version + namespace triples. ">SBMLExtensionNamespaces</a> object, as well as the method <code>connectToChild()</code>. Here is an example from the Groups package: </p><div class="fragment"><div class="line"><a class="code" href="class_group.html#a67a3515c557559610717fd77283c84b9">Group::Group</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> level, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> version, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pkgVersion) </div><div class="line">  : <a class="code" href="class_s_base.html">SBase</a> (level, version)</div><div class="line">   ,mId(<span class="stringliteral">&quot;&quot;</span>)</div><div class="line">   ,mName(<span class="stringliteral">&quot;&quot;</span>)</div><div class="line">   ,mKind(<a class="code" href="_groups_extension_8h.html#a694e53b03766f3518893708f3167a384a6f8d278c0c78f4eea77ef7e9ece7d048">GROUP_KIND_UNKNOWN</a>)</div><div class="line">   ,mMembers(level, version, pkgVersion)</div><div class="line">   ,mMemberConstraints (level, version, pkgVersion)</div><div class="line">{</div><div class="line">  <span class="comment">// set an SBMLNamespaces derived object of this package</span></div><div class="line">  setSBMLNamespacesAndOwn(<span class="keyword">new</span> <a class="code" href="_groups_extension_8h.html#adee9b080ccff4167ff881364bd7aa902">GroupsPkgNamespaces</a>(level, version, pkgVersion));</div><div class="line"></div><div class="line">  <span class="comment">// connect to child objects</span></div><div class="line">  connectToChild();</div><div class="line">}</div></div><!-- fragment --> <p class="endli"></p>
</li>
<li>
<p class="startli">Define a constructor that accepts an <a class="el" href="class_s_b_m_l_namespaces.html" title=" Set of SBML Level + Version + namespace triples. ">SBMLNamespaces</a> object. This constructor needs to call three methods, as illustrated in the body of this example from the Groups package: </p><div class="fragment"><div class="line"><a class="code" href="class_group.html#a67a3515c557559610717fd77283c84b9">Group::Group</a>(GroupsPkgNamespaces* groupsns)</div><div class="line"> : <a class="code" href="class_s_base.html">SBase</a>(groupsns)</div><div class="line">  ,mId(<span class="stringliteral">&quot;&quot;</span>)</div><div class="line">  ,mName(<span class="stringliteral">&quot;&quot;</span>)</div><div class="line">  ,mKind(<a class="code" href="_groups_extension_8h.html#a694e53b03766f3518893708f3167a384a6f8d278c0c78f4eea77ef7e9ece7d048">GROUP_KIND_UNKNOWN</a>)</div><div class="line">  ,mMembers(groupsns)</div><div class="line">   ,mMemberConstraints (groupsns)</div><div class="line">{</div><div class="line">  <span class="comment">// set the element namespace of this object</span></div><div class="line">  setElementNamespace(groupsns-&gt;getURI());</div><div class="line"></div><div class="line">  <span class="comment">// connect to child objects</span></div><div class="line">  connectToChild();</div><div class="line"></div><div class="line">  <span class="comment">// load package extensions bound with this object (if any) </span></div><div class="line">  loadPlugins(groupsns);</div><div class="line">}</div></div><!-- fragment --> <p>The call to <code>loadPlugins(...)</code> is necessary to allow the package to be extended by <em>other</em> package extensions. It is also worth noting that the constructor for <a class="el" href="class_s_b_m_l_namespaces.html" title=" Set of SBML Level + Version + namespace triples. ">SBMLNamespaces</a> and its derived class <a class="el" href="class_s_b_m_l_extension_namespaces.html" title=" Set of SBML Level + Version + namespace triples. ">SBMLExtensionNamespaces</a> throw an <a class="el" href="class_s_b_m_l_extension_exception.html" title=" Exception used by package extensions ">SBMLExtensionException</a> if the argument it is given is invalid. Callers will have to create the object using code such as the following example from the Layout package: </p><div class="fragment"><div class="line"><span class="keywordflow">try</span></div><div class="line">{</div><div class="line">  LayputPkgNamespaces layoutns(3, 1, 1);</div><div class="line">  <a class="code" href="class_layout.html">Layout</a>              layout(&amp;layoutns); </div><div class="line">}</div><div class="line"><span class="keywordflow">catch</span> (<a class="code" href="class_s_b_m_l_extension_exception.html">SBMLExtensionException</a> e)</div><div class="line">{</div><div class="line">  cerr &lt;&lt; <span class="stringliteral">&quot;Caught &quot;</span> &lt;&lt; e.what() &lt;&lt; endl;</div><div class="line">}</div></div><!-- fragment --> <p class="endli"></p>
</li>
<li>
<p class="startli">Override the copy constructor, assignment operator, and <code>clone()</code> methods from <a class="el" href="class_s_base.html" title=" SBML&#39;s SBase class, base class of most SBML objects. ">SBase</a> and implement appropriate versions for the package.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override the following virtual methods if the object defines "id" and "name" attributes: <code>setId(...)</code>, <code>setName(...)</code>, <code>isSetId(...)</code>, <code>isSetName(...)</code>, <code>unsetId(...)</code>, <code>unsetName(...)</code>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">If the SBML object defines any other attributes, then for every attribute defined by the class, implement new methods to set, get, unset, and query the attribute value. For an attribute named <span class="placeholder">ATTRIB</span>, this will lead to methods named <code>set<span class="placeholder-nospace">ATTRIB</span></code>, <code>get<span class="placeholder-nospace">ATTRIB</span></code>, <code>isSet<span class="placeholder-nospace">ATTRIB</span></code>, and <code>unset<span class="placeholder-nospace">ATTRIB</span></code>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override the following virtual methods if the object defines any attributes:</p>
<ul>
<li>
<p class="startli"><code>addExpectedAttributes(ExpectedAttributes&amp; attributes)</code>: This method should add the attributes that are expected to be found on this kind of extended object in an SBML file or data stream.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>readAttributes(<a class="el" href="class_x_m_l_attributes.html" title=" A list of attributes on an XML element. ">XMLAttributes</a>&amp; attributes, ExpectedAttributes&amp; expectedAttributes)</code>: This method should read the attributes expected to be found on this kind of extended object in an SBML file or data stream.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>hasRequiredAttributes()</code>: This method should return <code>true</code> if all of the required attribute for this extended object are present on instance of the object.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>writeAttributes(XMLOutputStream&amp; stream)</code>: This method should write out the attributes of an extended object. The implementation should use the different kinds of <code>writeAttribute</code> methods defined by <a class="el" href="class_x_m_l_output_stream.html" title=" Interface to an XML output stream. ">XMLOutputStream</a> to achieve this.</p>
<p class="endli"></p>
</li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override the following virtual methods if the object defines one or more subobjects:</p>
<ul>
<li>
<p class="startli"><code>createObject(XMLInputStream&amp; stream)</code>: Subclasses must override this method to create, store, and then return an SBML object corresponding to the next <a class="el" href="class_x_m_l_token.html" title=" A token in an XML stream. ">XMLToken</a> in the <a class="el" href="class_x_m_l_input_stream.html" title=" An interface to an XML input stream. ">XMLInputStream</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>connectToParent(SBase *sbase)</code>: This creates a parent-child relationship between a given extended object and its subcomponent(s).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>setSBMLDocument(SBMLDocument* d)</code>: This method should set the parent <a class="el" href="class_s_b_m_l_document.html" title=" Overall SBML container object. ">SBMLDocument</a> object on the subcomponent object instances, so that the subcomponent instances know which <a class="el" href="class_s_b_m_l_document.html" title=" Overall SBML container object. ">SBMLDocument</a> contains them.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>enablePackageInternal(std::string&amp; pkgURI, std::string&amp; pkgPrefix, bool flag)</code>: This method should enable or disable the subcomponent based on whether a given XML namespace is active.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>writeElements(XMLOutputStream&amp; stream)</code>: This method must be overridden to provide an implementation that will write out the expected subcomponents/subelements to the XML output stream.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>readOtherXML(SBase* parentObject, XMLInputStream&amp; stream)</code>: This function should be overridden if XML elements containing annotations, notes, MathML content, etc., need to be directly parsed from the given <a class="el" href="class_x_m_l_input_stream.html" title=" An interface to an XML input stream. ">XMLInputStream</a> object.</p>
<p class="endli"></p>
</li>
<li>
<code>hasRequiredElements()</code>: This method should return <code>true</code> if a given object contains all the required subcomponents defined by the specification for that SBML Level&#160;3 package. </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override the virtual method <code>writeXMLNS(<a class="el" href="class_x_m_l_output_stream.html" title=" Interface to an XML output stream. ">XMLOutputStream</a>&amp; stream)</code> if the package needs to add additional <code>xmlns</code> attributes to declare additional XML namespace URIs. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Define any additional methods needed by the class, for example to add and remove subobjects.</p>
<p class="endli"></p>
</li>
</ol>
</li>
</ol>
<p>In the directory structure for packages (Section <a class="el" href="libsbml-howto-implement-extension.html#implem-dir">1. Create the directory structure</a>), the code for new object classes is placed in the subdirectory named <code>sbml</code>.</p>
<p>Developers can take advantage of the many package implementations available for libSBML to see real-life examples of objects derived from <a class="el" href="class_s_base.html" title=" SBML&#39;s SBase class, base class of most SBML objects. ">SBase</a>.</p>
<h1><a class="anchor" id="implem-sbmlext"></a>
5. Derive a class from SBMLExtension</h1>
<p>The <a class="el" href="class_s_b_m_l_extension.html" title=" Base class for SBML Level 3 package plug-ins. ">SBMLExtension</a> class is an abstract class that must be extended by each package extension implementation. The class provides methods for managing common attributes of package extensions (e.g., the SBML package name, the package version, and more), registration of instantiated <a class="el" href="class_s_base_plugin_creator.html" title=" Template for SBasePlugin factory objects. ">SBasePluginCreator</a> objects, and initialization/registration of package extensions when the library code for the package is loaded by libSBML.</p>
<p>The documentation for <a class="el" href="class_s_b_m_l_extension.html" title=" Base class for SBML Level 3 package plug-ins. ">SBMLExtension</a> explains in detail the process of extending the class as part of the implementation of a package extension. The following is a summary of the steps:</p>
<ol>
<li>
<p class="startli">Define a <code>getPackageName()</code> method that returns the name of the package as a string.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Define a set of methods that return the default SBML Level, SBML Version and version of the package.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Define methods returning the package namespace URIs</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override basic pure virtual methods on <a class="el" href="class_s_b_m_l_extension.html" title=" Base class for SBML Level 3 package plug-ins. ">SBMLExtension</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Create definitions derived from <a class="el" href="class_s_b_m_l_extension_namespaces.html" title=" Set of SBML Level + Version + namespace triples. ">SBMLExtensionNamespaces</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override the <a class="el" href="class_s_b_m_l_extension.html" title=" Base class for SBML Level 3 package plug-ins. ">SBMLExtension</a> method <code>getSBMLExtensionNamespaces()</code>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Define an enumeration for the package object type codes.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Override the <a class="el" href="class_s_b_m_l_extension.html" title=" Base class for SBML Level 3 package plug-ins. ">SBMLExtension</a> method <code>getStringFromTypeCode()</code>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Implement an <code>init()</code> method.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Instantiate a global <a class="el" href="class_s_b_m_l_extension_register.html" title=" Template class for extension package registration ">SBMLExtensionRegister</a> object.</p>
<p class="endli"></p>
</li>
</ol>
<h1><a class="anchor" id="forward-decl"></a>
6. Implement a forward declaration file</h1>
<p>Create a file that provides forward declarations for all classes defined by the package extension. In the directory structure for packages (Section <a class="el" href="libsbml-howto-implement-extension.html#implem-dir">1. Create the directory structure</a>), this file should be placed in the subdirectory named <code>common</code>. Here is an example from the Layout package; this can be found in the file <code>src/packages/layout/common/layoutfwd.h</code>. The definition of <code>CLASS_OR_STRUCT</code> is to permit this code to work for both C and C++:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef layoutfwd_h__</span></div><div class="line"><span class="preprocessor">#define layoutfwd_h__</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifdef __cplusplus</span></div><div class="line"><span class="preprocessor">#  define CLASS_OR_STRUCT class</span></div><div class="line"><span class="preprocessor">#else</span></div><div class="line"><span class="preprocessor">#  define CLASS_OR_STRUCT struct</span></div><div class="line"><span class="preprocessor">#endif  </span><span class="comment">/* __cplusplus */</span><span class="preprocessor"></span></div><div class="line"></div><div class="line"><a class="code" href="libsbml-namespace_8h.html#a41d9f1012efdaa799c31e8e4ddde0fbd">LIBSBML_CPP_NAMESPACE_BEGIN</a></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_bounding_box.html">BoundingBox</a>                     <a class="code" href="layoutfwd_8h.html#a0b333b9c2204d52127b1ac7d0b4bb8f4">BoundingBox_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_compartment_glyph.html">CompartmentGlyph</a>                <a class="code" href="layoutfwd_8h.html#a1a95d91d450f3deda5bcf2af09aa830f">CompartmentGlyph_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_cubic_bezier.html">CubicBezier</a>                     <a class="code" href="layoutfwd_8h.html#a899e2ceab8b2218357843238c9c9f720">CubicBezier_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_curve.html">Curve</a>                           <a class="code" href="layoutfwd_8h.html#a1df20c978e5ecf6332e20f60cd52ff80">Curve_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_dimensions.html">Dimensions</a>                      <a class="code" href="layoutfwd_8h.html#a0e6ac46029a5226544f291eba447fa1a">Dimensions_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_general_glyph.html">GeneralGlyph</a>                    <a class="code" href="layoutfwd_8h.html#a27837361eba9519817d1a6ad64f6d11f">GeneralGlyph_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_graphical_object.html">GraphicalObject</a>                 <a class="code" href="layoutfwd_8h.html#abb168b4a7c32125fe0c2a88293a9bbf9">GraphicalObject_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_layout.html">Layout</a>                          <a class="code" href="layoutfwd_8h.html#aa672640788a12f1e0a746aa6377f9286">Layout_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_line_segment.html">LineSegment</a>                     <a class="code" href="layoutfwd_8h.html#a31e7305a6c49c2c93a3f7c190765f1b3">LineSegment_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_point.html">Point</a>                           <a class="code" href="layoutfwd_8h.html#a6f3eaf27774b06a6e615ff7f4048f99d">Point_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_reaction_glyph.html">ReactionGlyph</a>                   <a class="code" href="layoutfwd_8h.html#aeeb8561be33c83bd9a89bcaecf0ccbb8">ReactionGlyph_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_reference_glyph.html">ReferenceGlyph</a>                  <a class="code" href="layoutfwd_8h.html#a909fed9e913c33b208954cd6c3c09690">ReferenceGlyph_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_species_glyph.html">SpeciesGlyph</a>                    <a class="code" href="layoutfwd_8h.html#ae70e0d0acc7bf67230f3539f304c7f87">SpeciesGlyph_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_species_reference_glyph.html">SpeciesReferenceGlyph</a>           <a class="code" href="layoutfwd_8h.html#a232236cc2c304d09ffa01aaee80fb8e5">SpeciesReferenceGlyph_t</a>;</div><div class="line"><span class="keyword">typedef</span> <a class="code" href="sbmlfwd_8h.html#ad725f68d30137fe401efd64d159f84b6">CLASS_OR_STRUCT</a> <a class="code" href="class_text_glyph.html">TextGlyph</a>                       <a class="code" href="layoutfwd_8h.html#a8e2e4c6ae29ac64809a21007050c15de">TextGlyph_t</a>;</div><div class="line"></div><div class="line"><a class="code" href="libsbml-namespace_8h.html#ab1841eceb76d5f2baade2e6b6ffec7c1">LIBSBML_CPP_NAMESPACE_END</a></div><div class="line"></div><div class="line"><span class="preprocessor">#undef CLASS_OR_STRUCT</span></div><div class="line"></div><div class="line"><span class="preprocessor">#endif  </span><span class="comment">/* layoutfwd_h__ */</span><span class="preprocessor"></span></div></div><!-- fragment --><h1><a class="anchor" id="header-file"></a>
7. Implement a package header file</h1>
<p>Create a single header file that includes all other package header files necessary to declare the types defined by the package extension. In the directory structure for packages (Section <a class="el" href="libsbml-howto-implement-extension.html#implem-dir">1. Create the directory structure</a>), this file should be placed in the subdirectory named <code>common</code>. Here is an example from the Layout package; this can be found in the file <code>src/packages/layout/common/LayoutExtensionTypes.h</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef LayoutExtensionTypes_h</span></div><div class="line"><span class="preprocessor">#define LayoutExtensionTypes_h</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="layoutfwd_8h.html">sbml/packages/layout/common/layoutfwd.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_layout_extension_8h.html">sbml/packages/layout/extension/LayoutExtension.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_layout_model_plugin_8h.html">sbml/packages/layout/extension/LayoutModelPlugin.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_layout_s_b_m_l_document_plugin_8h.html">sbml/packages/layout/extension/LayoutSBMLDocumentPlugin.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_bounding_box_8h.html">sbml/packages/layout/sbml/BoundingBox.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_compartment_glyph_8h.html">sbml/packages/layout/sbml/CompartmentGlyph.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_cubic_bezier_8h.html">sbml/packages/layout/sbml/CubicBezier.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_curve_8h.html">sbml/packages/layout/sbml/Curve.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_dimensions_8h.html">sbml/packages/layout/sbml/Dimensions.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_graphical_object_8h.html">sbml/packages/layout/sbml/GraphicalObject.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_layout_8h.html">sbml/packages/layout/sbml/Layout.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_line_segment_8h.html">sbml/packages/layout/sbml/LineSegment.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_point_8h.html">sbml/packages/layout/sbml/Point.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_reaction_glyph_8h.html">sbml/packages/layout/sbml/ReactionGlyph.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_species_glyph_8h.html">sbml/packages/layout/sbml/SpeciesGlyph.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_species_reference_glyph_8h.html">sbml/packages/layout/sbml/SpeciesReferenceGlyph.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_species_reference_role_8h.html">sbml/packages/layout/sbml/SpeciesReferenceRole.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_text_glyph_8h.html">sbml/packages/layout/sbml/TextGlyph.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_reference_glyph_8h.html">sbml/packages/layout/sbml/ReferenceGlyph.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_general_glyph_8h.html">sbml/packages/layout/sbml/GeneralGlyph.h</a>&gt;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#endif  </span><span class="comment">/* LayoutExtensionTypes_h */</span><span class="preprocessor"></span></div></div><!-- fragment --><h1><a class="anchor" id="config-macros"></a>
8. Define files for package registration</h1>
<p>Two files need to be created in <code>src/sbml/packages</code> as part of the libSBML scheme for including packages at compilation time. The first file should be named <code><span class="placeholder">name</span>-register.h</code>, where <code><span class="placeholder">name</span></code> is the name of the package extension. Here is an example from the Groups package, in the file <code>src/sbml/packages/groups-register.h</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifdef USE_GROUPS</span></div><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_groups_extension_8h.html">sbml/packages/groups/extension/GroupsExtension.h</a>&gt;</span></div><div class="line"><span class="preprocessor">#endif  </span></div></div><!-- fragment --><p>Note the contents in the file above: it includes the extension file in the package source directory (<code>GroupExtension.h</code>), and it uses a <code>ifdef</code> condition on a variable named <code>USE_<span class="placeholder">NAME</span></code>, where <code><span class="placeholder">NAME</span></code> is the package name.</p>
<p>The second file should be named <code><span class="placeholder">name</span>-register.cxx</code>. It will be used as an inclusion by another part of libSBML to invoke the <code>init()</code> method of the class created in step&#160;4 above (<a class="el" href="libsbml-howto-implement-extension.html#implem-sbmlext">5. Derive a class from SBMLExtension</a>). This file should have content as shown in the next example taken from <code>src/sbml/packages/groups-register.cxx</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#ifdef USE_GROUPS</span></div><div class="line">GroupsExtension::init();</div><div class="line"><span class="preprocessor">#endif  </span></div></div><!-- fragment --><h1><a class="anchor" id="hook-bindings"></a>
9. Hook into the language bindings</h1>
<p>This part of the process is unfortunately one of the most complex to perform and to describe. The simplest approach is to copy the files from an existing package implementation and modify them to work with the names and objects defined in the new package. The following are the relevant language binding files for C#, Java, Perl, Python, R and Ruby for a package such as Groups:</p>
<pre class="fragment">src/bindings/csharp/local-downcast-extension-groups.i
src/bindings/csharp/local-downcast-namespaces-groups.i
src/bindings/csharp/local-packages-groups.i

src/bindings/java/local-downcast-extension-groups.i
src/bindings/java/local-downcast-namespaces-groups.i
src/bindings/java/local-packages-groups.i

src/bindings/perl/local-downcast-extension-groups.cpp
src/bindings/perl/local-downcast-namespaces-groups.cpp
src/bindings/perl/local-downcast-packages-groups.cpp
src/bindings/perl/local-downcast-plugins-groups.cpp
src/bindings/perl/local-groups.i

src/bindings/python/local-downcast-extension-groups.cpp
src/bindings/python/local-downcast-namespaces-groups.cpp
src/bindings/python/local-downcast-packages-groups.cpp
src/bindings/python/local-downcast-plugins-groups.cpp
src/bindings/python/local-groups.i

src/bindings/r/local-downcast-extension-groups.cpp
src/bindings/r/local-downcast-namespaces-groups.cpp
src/bindings/r/local-downcast-packages-groups.cpp
src/bindings/r/local-downcast-plugins-groups.cpp
src/bindings/r/local-groups.i

src/bindings/ruby/local-downcast-extension-groups.cpp
src/bindings/ruby/local-downcast-namespaces-groups.cpp
src/bindings/ruby/local-downcast-packages-groups.cpp
src/bindings/ruby/local-downcast-plugins-groups.cpp
src/bindings/ruby/local-groups.i

src/bindings/swig/groups-package.h
src/bindings/swig/groups-package.i
</pre><h1><a class="anchor" id="hook-build"></a>
10. Hook into the libSBML build system</h1>
<p>Inclusion and compilation of packages in libSBML is supported through the use of the CMake system. To connect a new package extension to the rest of the libSBML build system, two CMake files have to be created: (1) a CMake file to compile the various parts of the package implementation, and (2) a CMake file that connects the package to the rest of the libSBML build system.</p>
<ol>
<li>
<p class="startli"><em>CMake file to compile the package code</em>. Create a <code><span class="placeholder">name</span>-package.cmake</code> file at the top level of the libSBML source tree, <code>/src</code>, where <span class="placeholder">name</span> is the name of the package. Here is an example of the <code>groups-package.cmake</code> file from the Groups package: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;if(ENABLE_GROUPS)</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;  include(${LIBSBML_ROOT_SOURCE_DIR}/groups-package.cmake)</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  <span class="comment"># Go through all the Groups directories and build a list of files.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  set(GROUPS_SOURCES)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  foreach(dir common extension sbml validator)</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    include_directories(${CMAKE_CURRENT_SOURCE_DIR}/sbml/packages/groups/${dir})</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    file(GLOB current ${CMAKE_CURRENT_SOURCE_DIR}/sbml/packages/groups/${dir}/*.cpp</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                      ${CMAKE_CURRENT_SOURCE_DIR}/sbml/packages/groups/${dir}/*.c</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                      ${CMAKE_CURRENT_SOURCE_DIR}/sbml/packages/groups/${dir}/*.h)</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    </div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="comment"># Special handling for the validator: set the *Constraints.cpp files to be</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="comment"># &#39;header&#39; files so they won&#39;t be compiled. They are #included directly instead.</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">if</span> (<span class="stringliteral">&quot;${dir}&quot;</span> STREQUAL <span class="stringliteral">&quot;validator/constraints&quot;</span>)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      foreach(tempFile ${current})</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;        <span class="keywordflow">if</span> (<span class="stringliteral">&quot;${tempFile}&quot;</span> MATCHES <span class="stringliteral">&quot;.*Constraints.cpp&quot;</span>)</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;          set_source_files_properties(</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;            ${tempFile}</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;            PROPERTIES HEADER_FILE_ONLY true</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;            )</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;        endif()</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      endforeach()</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    endif()</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    set(GROUPS_SOURCES ${GROUPS_SOURCES} ${current})</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    </div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment"># Mark header files for installation.</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    file(GLOB groups_headers ${CMAKE_CURRENT_SOURCE_DIR}/sbml/packages/groups/${dir}/*.h)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    install(FILES ${groups_headers} DESTINATION include/sbml/packages/groups/${dir} )</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  endforeach()</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment"># Create source group files for IDEs.</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  source_group(groups_package FILES ${GROUPS_SOURCES})</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="comment"># Add the Groups package sources to libSBML sources.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  SET(LIBSBML_SOURCES ${LIBSBML_SOURCES} ${GROUPS_SOURCES})</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="comment"># Add unit test files.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  if(WITH_CHECK)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    add_subdirectory(sbml/packages/groups/extension/test)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  endif()</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;endif()</div></div><!-- fragment --> <p class="endli"></p>
</li>
<li>
<p class="startli"><em>CMake file to connect the package to the rest of libSBML's build system</em>. In the libSBML top-level, create another (different) file named <code><span class="placeholder">name</span>-package.cmake</code>, where <span class="placeholder">name</span> is the name of the package. The file should contain code that looks like the following, where this example is drawn from the Layout package:</p>
<div class="fragment"><div class="line">option(ENABLE_GROUPS</div><div class="line"><span class="stringliteral">&quot;Enable libSBML support for the SBML Level 3 Groups (&#39;groups&#39;) package.&quot;</span> OFF)</div><div class="line"></div><div class="line"><span class="preprocessor"># Provide summary status                                    =</span></div><div class="line">list(APPEND LIBSBML_PACKAGE_SUMMARY <span class="stringliteral">&quot;SBML &#39;groups&#39; package  = ${ENABLE_GROUPS}&quot;</span>)</div><div class="line"></div><div class="line"><span class="keywordflow">if</span>(ENABLE_GROUPS)</div><div class="line">  add_definitions(-DUSE_GROUPS)</div><div class="line">  set(LIBSBML_PACKAGE_INCLUDES ${LIBSBML_PACKAGE_INCLUDES} <span class="stringliteral">&quot;LIBSBML_HAS_PACKAGE_GROUPS&quot;</span>)</div><div class="line">  list(APPEND SWIG_EXTRA_ARGS -DUSE_GROUPS)</div><div class="line">  list(APPEND SWIG_SWIGDOCDEFINES --define <a class="code" href="libsbml-config-common_8h.html#a4e4ee4ceafa4e3afba82cbebb4002aa2">USE_GROUPS</a>)</div><div class="line">endif()</div></div><!-- fragment --><p>An implementation starting with the code above could simply replace the string <code>GROUPS</code> with the appropriate name of the package. </p>
<p class="endli"></p>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for Doxygen -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">
      Visit <a href="http://sbml.org">SBML.org</a> for more information
    about SBML and libSBML.
    </li>
   </ul>
</div>
</body>
</html>
